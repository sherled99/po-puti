{"ast":null,"code":"const _url = \"https://igorbakhtin1-dostavochkaapi-2cf2.twc1.net\";\nexport const getGender = async () => {\n  return _request(`${_url}/Gender/AllGenders`, {\n    method: \"GET\"\n  });\n};\nexport const registerUser = async data => {\n  return _request(`${_url}/User/register`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(data)\n  });\n};\nexport const loginUser = async data => {\n  return _request(`${_url}/User/login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(data)\n  });\n};\nconst _request = (url, options) => {\n  return fetch(url, options).then(res => _checkResponse(res)).then(res => _checkSuccess(res)).catch(err => {\n    console.error(err);\n    throw new Error('Network error');\n  });\n};\nconst _checkResponse = async res => {\n  // Проверка наличия тела ответа\n  const contentType = res.headers.get('Content-Type');\n  if (res.ok) {\n    if (contentType && contentType.includes('application/json')) {\n      return res.json(); // Если есть тело ответа в формате JSON\n    } else {\n      return {}; // Возвращаем пустой объект, если тела нет\n    }\n  } else {\n    const errorText = await res.text(); // Читаем текст ошибки, если ответ не успешен\n    try {\n      const errorJson = JSON.parse(errorText);\n      return Promise.reject(errorJson); // Попытка разобрать текст как JSON\n    } catch (e) {\n      return Promise.reject({\n        message: errorText\n      }); // Если текст не является JSON, возвращаем его как текст\n    }\n  }\n};\nconst _checkSuccess = res => {\n  if (!res) {\n    throw new Error(`Ошибка: ${res}`);\n  }\n\n  // Проверка наличия заголовков Set-Cookie\n  const cookies = res.headers.get('Set-Cookie');\n  if (cookies) {\n    console.log('Cookies set by server:', cookies);\n  } else {\n    console.warn('No cookies were set by the server.');\n  }\n  return res;\n};","map":{"version":3,"names":["_url","getGender","_request","method","registerUser","data","headers","body","JSON","stringify","loginUser","url","options","fetch","then","res","_checkResponse","_checkSuccess","catch","err","console","error","Error","contentType","get","ok","includes","json","errorText","text","errorJson","parse","Promise","reject","e","message","cookies","log","warn"],"sources":["C:/Users/georg/OneDrive/Рабочий стол/Web/Projects/React/new-test-for-connection/src/utils/api.ts"],"sourcesContent":["import { IOptions } from '../services/types/data';\r\nimport { IForecast, IGender, ILogin, IRegister } from '../services/types/data';\r\n\r\nconst _url = \"https://igorbakhtin1-dostavochkaapi-2cf2.twc1.net\";\r\n\r\nexport const getGender = async (): Promise<Array<IGender>> => {\r\n  return _request(`${_url}/Gender/AllGenders`, {\r\n    method: \"GET\"\r\n  });\r\n};\r\n\r\nexport const registerUser = async (data: IRegister): Promise<any> => {\r\n  return _request(`${_url}/User/register`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nexport const loginUser = async (data: ILogin): Promise<any> => {\r\n  return _request(`${_url}/User/login`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify(data),\r\n  });\r\n};\r\n\r\nconst _request = (url: string, options?: IOptions) => {\r\n  return fetch(url, options)\r\n    .then((res) => _checkResponse(res))\r\n    .then((res) => _checkSuccess(res))\r\n    .catch((err) => {\r\n      console.error(err);\r\n      throw new Error('Network error');\r\n    });\r\n};\r\n\r\nconst _checkResponse = async (res: Response) => {\r\n  // Проверка наличия тела ответа\r\n  const contentType = res.headers.get('Content-Type');\r\n  \r\n  if (res.ok) {\r\n    if (contentType && contentType.includes('application/json')) {\r\n      return res.json(); // Если есть тело ответа в формате JSON\r\n    } else {\r\n      return {}; // Возвращаем пустой объект, если тела нет\r\n    }\r\n  } else {\r\n    const errorText = await res.text(); // Читаем текст ошибки, если ответ не успешен\r\n    try {\r\n      const errorJson = JSON.parse(errorText);\r\n      return Promise.reject(errorJson); // Попытка разобрать текст как JSON\r\n    } catch (e) {\r\n      return Promise.reject({ message: errorText }); // Если текст не является JSON, возвращаем его как текст\r\n    }\r\n  }\r\n};\r\n\r\n\r\nconst _checkSuccess = (res: any) => {\r\n  if (!res) {\r\n    throw new Error(`Ошибка: ${res}`);\r\n  }\r\n\r\n  // Проверка наличия заголовков Set-Cookie\r\n  const cookies = res.headers.get('Set-Cookie');\r\n  if (cookies) {\r\n    console.log('Cookies set by server:', cookies);\r\n  } else {\r\n    console.warn('No cookies were set by the server.');\r\n  }\r\n\r\n  return res;\r\n};\r\n"],"mappings":"AAGA,MAAMA,IAAI,GAAG,mDAAmD;AAEhE,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAqC;EAC5D,OAAOC,QAAQ,CAAC,GAAGF,IAAI,oBAAoB,EAAE;IAC3CG,MAAM,EAAE;EACV,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,MAAOC,IAAe,IAAmB;EACnE,OAAOH,QAAQ,CAAC,GAAGF,IAAI,gBAAgB,EAAE;IACvCG,MAAM,EAAE,MAAM;IACdG,OAAO,EAAE;MACP,cAAc,EAAE;IAClB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,IAAI;EAC3B,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMK,SAAS,GAAG,MAAOL,IAAY,IAAmB;EAC7D,OAAOH,QAAQ,CAAC,GAAGF,IAAI,aAAa,EAAE;IACpCG,MAAM,EAAE,MAAM;IACdG,OAAO,EAAE;MACP,cAAc,EAAE;IAClB,CAAC;IACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACJ,IAAI;EAC3B,CAAC,CAAC;AACJ,CAAC;AAED,MAAMH,QAAQ,GAAGA,CAACS,GAAW,EAAEC,OAAkB,KAAK;EACpD,OAAOC,KAAK,CAACF,GAAG,EAAEC,OAAO,CAAC,CACvBE,IAAI,CAAEC,GAAG,IAAKC,cAAc,CAACD,GAAG,CAAC,CAAC,CAClCD,IAAI,CAAEC,GAAG,IAAKE,aAAa,CAACF,GAAG,CAAC,CAAC,CACjCG,KAAK,CAAEC,GAAG,IAAK;IACdC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC;IAClB,MAAM,IAAIG,KAAK,CAAC,eAAe,CAAC;EAClC,CAAC,CAAC;AACN,CAAC;AAED,MAAMN,cAAc,GAAG,MAAOD,GAAa,IAAK;EAC9C;EACA,MAAMQ,WAAW,GAAGR,GAAG,CAACT,OAAO,CAACkB,GAAG,CAAC,cAAc,CAAC;EAEnD,IAAIT,GAAG,CAACU,EAAE,EAAE;IACV,IAAIF,WAAW,IAAIA,WAAW,CAACG,QAAQ,CAAC,kBAAkB,CAAC,EAAE;MAC3D,OAAOX,GAAG,CAACY,IAAI,CAAC,CAAC,CAAC,CAAC;IACrB,CAAC,MAAM;MACL,OAAO,CAAC,CAAC,CAAC,CAAC;IACb;EACF,CAAC,MAAM;IACL,MAAMC,SAAS,GAAG,MAAMb,GAAG,CAACc,IAAI,CAAC,CAAC,CAAC,CAAC;IACpC,IAAI;MACF,MAAMC,SAAS,GAAGtB,IAAI,CAACuB,KAAK,CAACH,SAAS,CAAC;MACvC,OAAOI,OAAO,CAACC,MAAM,CAACH,SAAS,CAAC,CAAC,CAAC;IACpC,CAAC,CAAC,OAAOI,CAAC,EAAE;MACV,OAAOF,OAAO,CAACC,MAAM,CAAC;QAAEE,OAAO,EAAEP;MAAU,CAAC,CAAC,CAAC,CAAC;IACjD;EACF;AACF,CAAC;AAGD,MAAMX,aAAa,GAAIF,GAAQ,IAAK;EAClC,IAAI,CAACA,GAAG,EAAE;IACR,MAAM,IAAIO,KAAK,CAAC,WAAWP,GAAG,EAAE,CAAC;EACnC;;EAEA;EACA,MAAMqB,OAAO,GAAGrB,GAAG,CAACT,OAAO,CAACkB,GAAG,CAAC,YAAY,CAAC;EAC7C,IAAIY,OAAO,EAAE;IACXhB,OAAO,CAACiB,GAAG,CAAC,wBAAwB,EAAED,OAAO,CAAC;EAChD,CAAC,MAAM;IACLhB,OAAO,CAACkB,IAAI,CAAC,oCAAoC,CAAC;EACpD;EAEA,OAAOvB,GAAG;AACZ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}